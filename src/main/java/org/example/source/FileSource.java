package org.example.source;import org.apache.flink.configuration.Configuration;import org.apache.flink.streaming.api.functions.source.RichSourceFunction;import org.example.util.FileUtil;/** * @author jack * @date 2019/4/29 15:48 **/public class FileSource extends RichSourceFunction<String> {    private String fileName;    private String result;    private boolean flag = true;    public FileSource(String fileName) {        this.fileName = fileName;    }    @Override    public void open(Configuration parameters) throws Exception {        result = FileUtil.readRelativeFileBy(fileName);        super.open(parameters);    }    @Override    public void run(SourceContext<String> ctx) throws Exception {//         while (flag) {//         ctx.collect(result);//         Thread.sleep(10000);//         }       ctx.collect(result);    }    @Override    public void cancel() {        flag = false;    }}